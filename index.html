<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Walk-In Refrigerated Room Analysis</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Configure Tailwind to use the Inter font -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f4f7f9;
        }
        /* Custom CSS for print styling */
        @media print {
            body { background-color: white; }
            .print-hidden { display: none !important; }
            .page-break { page-page-break-before: always; }
            .print-section {
                border-top: 2px solid #0ea5e9; /* Changed to sky-500 */
                padding-top: 1rem;
                margin-top: 1rem;
            }
            .form-card {
                box-shadow: none !important;
                border: none !important;
            }
            input:not([type="radio"]):not([type="checkbox"]), textarea, select {
                border: none !important;
                border-bottom: 1px solid #9ca3af !important;
                padding: 0.25rem 0 !important;
                border-radius: 0 !important;
            }
            .collapse-content {
                display: block !important; /* Force sections to be visible on print */
            }
        }
        .collapse-content {
            transition: all 0.3s ease-in-out;
            max-height: 0;
            overflow: hidden;
        }
        .collapse-content.open {
            max-height: 3000px; /* Increased max-height for new section */
        }
        .collapse-header {
            cursor: pointer;
            user-select: none;
        }
    </style>
</head>

<body class="p-4 md:p-8">

    <div class="max-w-4xl mx-auto">
        <!-- BRANDED HEADER -->
        <header class="text-center mb-0 print-hidden bg-gray-900 p-6 rounded-t-xl shadow-lg">
            <!-- Logo matching website header -->
            <img src="https://i.imgur.com/YJvJw7V.png" alt="Mechanical Temp Logo" class="h-10 w-auto mx-auto mb-3">
            <h1 class="text-3xl font-extrabold text-sky-400">Refrigerated Room Analysis</h1>
            <p class="text-gray-400 mt-1">Walk-In Sizer Data Collection Tool</p>
        </header>

        <form id="sizerForm" class="form-card bg-white p-6 md:p-10 rounded-b-xl rounded-t-none shadow-2xl">
            <!-- ------------------------------------------------------------------- -->
            <!-- Helper Functions -->
            <!-- ------------------------------------------------------------------- -->
            <script>
                // --- Utility Functions ---

                function getInputValue(id, type = 'float') {
                    const el = document.getElementById(id);
                    if (!el) return 0;
                    const value = el.value.trim() === '' ? 0 : el.value;
                    return type === 'int' ? parseInt(value) : parseFloat(value);
                }

                function getRadioValue(name) {
                    const radio = document.querySelector(`input[name="${name}"]:checked`);
                    return radio ? radio.value : '';
                }

                // Function to toggle collapse state
                function toggleCollapse(id) {
                    const content = document.getElementById(id);
                    const arrow = document.getElementById(`arrow-${id}`);
                    content.classList.toggle('open');
                    arrow.classList.toggle('rotate-90');
                }

                // Function to handle conditional input visibility
                function toggleConditionalInput(radioName, targetId, requiredValue) {
                    const radios = document.getElementsByName(radioName);
                    const target = document.getElementById(targetId);
                    
                    radios.forEach(radio => {
                        radio.addEventListener('change', () => {
                            if (radio.checked && radio.value === requiredValue) {
                                target.classList.remove('hidden');
                                // Make inputs inside the conditional div required
                                target.querySelectorAll('input, textarea, select').forEach(el => el.required = true);
                            } else if (radio.checked && radio.value !== requiredValue) {
                                target.classList.add('hidden');
                                target.querySelectorAll('input, textarea, select').forEach(el => {
                                    el.required = false;
                                    el.value = ''; // Clear value when hidden
                                });
                            }
                        });
                    });

                    // Initial check on load
                    const initialCheck = Array.from(radios).find(radio => radio.checked && radio.value === requiredValue);
                    if (!initialCheck) {
                        target.classList.add('hidden');
                        target.querySelectorAll('input, textarea, select').forEach(el => el.required = false);
                    }
                }

                // --- NEW: Autofill Logic for Usage Type ---
                function updateUsageDefaults(usageType) {
                    let lights, personnelQty, personnelHours, motorsHP;

                    // Defaults are based on common industry standards for each usage type
                    switch (usageType) {
                        case 'Long Storage':
                            lights = 0.5; // Minimal or motion-activated lighting
                            personnelQty = 1;
                            personnelHours = 1; // 1 hour per day
                            motorsHP = 0.5; // Fan motors only
                            break;
                        case 'Heavy':
                            lights = 2.0; // Higher lighting density
                            personnelQty = 3; // More people working inside
                            personnelHours = 8; // Full shift access
                            motorsHP = 1.0; // Multiple fans / larger unit
                            break;
                        case 'Regular':
                        default:
                            lights = 1.5;
                            personnelQty = 1;
                            personnelHours = 4; // 4 hours per day
                            motorsHP = 0.5;
                            break;
                    }

                    document.getElementById('lightingWPerSqFt').value = lights;
                    document.getElementById('personnelQty').value = personnelQty;
                    document.getElementById('personnelHours').value = personnelHours;
                    document.getElementById('motorsHP').value = motorsHP;

                    calculateLoad(); // Trigger calculation after updating
                }
                
                // --- NEW: Location Visibility Logic ---
                function toggleSunExposure() {
                    const location = getRadioValue('boxLocation');
                    const sunExposureField = document.getElementById('sunExposureField');
                    const outdoorSunRadio = document.getElementById('outdoorFullSun');
                    const outdoorShadeRadio = document.getElementById('outdoorPartialShade');

                    if (location === 'Indoors') {
                        sunExposureField.classList.add('hidden');
                        // Set sun exposure to a neutral/default state when indoors
                        outdoorShadeRadio.checked = true; // Use shade as the base outdoor default
                    } else if (location === 'Outdoors') {
                        sunExposureField.classList.remove('hidden');
                        // Ensure at least one is selected when outdoors is picked
                        if (!outdoorSunRadio.checked && !outdoorShadeRadio.checked) {
                            outdoorShadeRadio.checked = true;
                        }
                    }
                    calculateLoad(); // Trigger calculation after updating
                }
                
                // --- NEW: Temperature and RH Autofill Logic ---
                const defaultSettings = {
                    'Restaurant/Food Service': { temp: 38, rh: 85 },
                    'Retail Store/Grocery': { temp: 35, rh: 80 },
                    'Industrial Process/Food Processing': { temp: 45, rh: 75 },
                    'Cold Storage Warehouse': { temp: 30, rh: 70 },
                    'Frozen Storage/Freezer': { temp: -10, rh: 'N/A' }, // Added for freezer scenario
                    'Floral/Science Lab': { temp: 40, rh: 90 },
                    'Other/General Use': { temp: 40, rh: 80 } // Default fallback
                };

                function updateTempRHDefaults() {
                    const application = document.getElementById('primaryApplication').value;
                    const settings = defaultSettings[application] || defaultSettings['Other/General Use'];

                    const tempInput = document.getElementById('desiredTemp');
                    const rhInput = document.getElementById('desiredRH');

                    tempInput.value = settings.temp;
                    rhInput.value = (settings.rh === 'N/A') ? '' : settings.rh;
                    rhInput.placeholder = (settings.rh === 'N/A') ? 'N/A for Freezers' : 'Humidity';

                    // Force recalculation when primary application changes
                    calculateLoad();
                }


                // Function to handle the print button
                function printForm() {
                    // Force open all sections before printing
                    document.querySelectorAll('.collapse-content').forEach(el => el.classList.add('open'));
                    window.print();
                    // Optionally close them again after print dialog is dismissed
                    setTimeout(() => {
                        document.querySelectorAll('.collapse-content').forEach(el => el.classList.remove('open'));
                    }, 500);
                }

                // Function to handle a simple message box (since alert() is forbidden)
                function showMessage(message, type = 'info') {
                    const container = document.getElementById('messageContainer');
                    const color = type === 'error' ? 'bg-red-100 border-red-400 text-red-700' : 'bg-green-100 border-green-400 text-green-700';
                    container.innerHTML = `
                        <div class="fixed top-4 right-4 p-4 rounded-lg border-l-4 ${color} shadow-lg z-50" role="alert">
                            <p class="font-bold">${type.toUpperCase()}</p>
                            <p>${message}</p>
                        </div>
                    `;
                    container.classList.remove('hidden');
                    setTimeout(() => {
                        container.classList.add('hidden');
                        container.innerHTML = '';
                    }, 3000);
                }
                
                // --- CORE ASHRAE-BASED CALCULATION LOGIC ---
                
                // ASHRAE Constant: R-values per inch (R/in) for common materials
                const R_VALUE_PER_INCH = {
                    'Polyurethane': 7.0, // Best insulation
                    'Urethane': 7.0,
                    'Styrofoam': 5.0,
                    'Fiberglass': 3.5,
                    'Concrete': 0.1, // Lowest insulation value
                    'Select Insulation Type': 7.0 // Default to common R-value for calculation safety
                };

                // ASHRAE Constant: Dynamic Personnel Load (BTU/hr per person) based on temperature
                function getPersonnelBTU(desiredTemp) {
                    // ASHRAE Handbook of Fundamentals (approximate data for general warehouse activity)
                    if (desiredTemp < 0) {
                        return 1100; // Freezer temps
                    } else if (desiredTemp < 35) {
                        return 1000; // Low temp cooler
                    } else {
                        return 900; // Medium temp cooler
                    }
                }
                
                // Load constants based on product type for better accuracy
                const productData = {
                    // Specific Heat (Btu/lb/°F), Respiration (BTU/day) - Simplified for estimation
                    'Generic Cooler Items': { specificHeat: 0.85, respirationLoadBTU: 0 }, 
                    'Chilled Meat/Poultry': { specificHeat: 0.80, respirationLoadBTU: 0 },
                    'Dairy/Milk/Eggs': { specificHeat: 0.90, respirationLoadBTU: 0 },
                    'Fresh Produce (Respiration Load)': { specificHeat: 0.92, respirationLoadBTU: 6000 }, // Conservative high respiration load
                    'Frozen Food (Below 32F)': { specificHeat: 0.40, respirationLoadBTU: 0 }, // Specific heat below freezing
                    'Beverages/Canned Goods': { specificHeat: 0.95, respirationLoadBTU: 0 },
                };

                function calculateLoad() {
                    // 1. Get Core Inputs
                    const boxLong = getInputValue('boxLong');
                    const boxWide = getInputValue('boxWide');
                    const boxHigh = getInputValue('boxHigh');
                    const desiredTemp = getInputValue('desiredTemp');
                    const ambientTemp = getInputValue('ambientTemp');
                    const maxLoadLbs = getInputValue('maxLoadLbs');
                    const enteringTemp = getInputValue('enteringTemp');
                    const finalTemp = getInputValue('finalTemp');
                    const pullDownHours = getInputValue('pulldownHours');
                    const personnelQty = getInputValue('personnelQty', 'int');
                    const personnelHours = getInputValue('personnelHours');
                    const lightingWPerSqFt = getInputValue('lightingWPerSqFt');
                    const motorsHP = getInputValue('motorsHP');
                    const boxUsage = getRadioValue('boxUsage'); // Get usage type
                    const productType = document.getElementById('productType').value; // Get product type
                    const insulationType = document.getElementById('insulationType').value; // Get insulation type

                    // Look up specific heat and respiration load
                    const productConstants = productData[productType] || productData['Generic Cooler Items'];
                    const specificHeat = productConstants.specificHeat;
                    const respirationLoadBTU_Day = productConstants.respirationLoadBTU;

                    const floorArea = boxLong * boxWide;
                    const wallArea = 2 * (boxLong * boxHigh) + 2 * (boxWide * boxHigh);
                    const ceilingArea = floorArea;
                    const totalSurfaceArea = floorArea + wallArea + ceilingArea;
                    const boxVolume = boxLong * boxWide * boxHigh;
                    const tempDifference = ambientTemp - desiredTemp;

                    // Guard clause for invalid dimensions or calculation parameters
                    if (boxLong <= 0 || boxWide <= 0 || boxHigh <= 0 || tempDifference <= 0) {
                        document.getElementById('totalLoadBTU').innerText = '0 BTU/hr';
                        document.getElementById('equipmentRecommendation').innerHTML = '<p class="text-red-500">Please enter valid Box Dimensions and Temperatures (Ambient > Desired) to calculate load.</p>';
                        // Reset all calculated values
                        document.getElementById('qTransmission').innerText = '0 BTU/hr';
                        document.getElementById('qInfiltration').innerText = '0 BTU/hr';
                        document.getElementById('qInternal').innerText = '0 BTU/hr';
                        document.getElementById('qChilling').innerText = '0 BTU/hr';
                        document.getElementById('qRespiration').innerText = '0 BTU/hr';
                        document.getElementById('loadRatioTransmission').innerText = '0%';
                        document.getElementById('loadRatioInfiltration').innerText = '0%';
                        document.getElementById('loadRatioInternal').innerText = '0%';
                        document.getElementById('loadRatioProduct').innerText = '0%';
                        return;
                    }

                    // --- CALCULATION CONSTANTS ---
                    
                    // DYNAMIC U-VALUE (ASHRAE Requirement)
                    // We assume a standard 4" walk-in panel for the R-value calculation for simplicity.
                    const R_PER_INCH = R_VALUE_PER_INCH[insulationType] || R_VALUE_PER_INCH['Polyurethane'];
                    const ASSUMED_THICKNESS = 4; // Use 4" as the standard box thickness for the average R-value
                    const U_VALUE = 1 / (R_PER_INCH * ASSUMED_THICKNESS); // U = 1/R
                    
                    // Heat Conversion (Watts to BTU/hr)
                    const WATTS_TO_BTU = 3.41;
                    // Heat Conversion (HP to BTU/hr)
                    const HP_TO_BTU = 2545;
                    // Air Density (Approx)
                    const AIR_DENSITY = 0.075; // lbs/ft³
                    // Specific Heat of Air
                    const CP_AIR = 0.24; // BTU/lb·°F
                    
                    const SAFETY_FACTOR = 1.15; // 15% safety margin
                    
                    // Usage Multiplier based on user input (for Infiltration FREQUENCY - ASHRAE ACH Equivalent Method)
                    let USAGE_MULTIPLIER;
                    switch (boxUsage) {
                        case 'Long Storage':
                            USAGE_MULTIPLIER = 1; // 1 air change equivalent per day
                            break;
                        case 'Heavy':
                            USAGE_MULTIPLIER = 12; // 12 air changes equivalent per day
                            break;
                        case 'Regular':
                        default:
                            USAGE_MULTIPLIER = 4; // 4 air changes equivalent per day
                            break;
                    }
                    
                    // --- 1. Transmission Load (Heat Leak) ---
                    // Q = U * A * dT (hourly) - ASHRAE fundamental heat transfer equation
                    const qTransmission = U_VALUE * totalSurfaceArea * tempDifference;

                    // --- 2. Infiltration Load (Door/Air Leakage - ASHRAE ACH Equivalent Method) ---
                    // Q_Infiltration = Volume * ACH_Equivalent * dT * AirDensity * Cp_Air / 24 hrs
                    const qInfiltration = boxVolume * USAGE_MULTIPLIER * tempDifference * AIR_DENSITY * CP_AIR / 24;


                    // --- 3. Internal Load (Lights, Motors, People) ---
                    const qLights = lightingWPerSqFt * floorArea * WATTS_TO_BTU;
                    const qMotors = motorsHP * HP_TO_BTU;
                    
                    // DYNAMIC PERSONNEL LOAD (ASHRAE Requirement)
                    const PERSONNEL_LOAD_BTU_HR = getPersonnelBTU(desiredTemp); 
                    const qPersonnel = personnelQty * PERSONNEL_LOAD_BTU_HR * (personnelHours / 24); 
                    const qInternal = qLights + qMotors + qPersonnel;

                    // --- 4. Product Load Components ---
                    let qChilling = 0;
                    if (pullDownHours > 0 && maxLoadLbs > 0 && (enteringTemp > finalTemp)) {
                        // Q_chilling = Mass * SpecificHeat * DeltaT / PullDownHours (hourly average)
                        qChilling = (maxLoadLbs * specificHeat * (enteringTemp - finalTemp)) / pullDownHours;
                    }
                    
                    // Respiration Load (Constant heat addition from living products, averaged over 24 hours)
                    const qRespiration = respirationLoadBTU_Day / 24;

                    const qProductTotal = qChilling + qRespiration;

                    // --- 5. Total Design Load ---
                    const totalDesignLoad = qTransmission + qInfiltration + qInternal + qProductTotal;
                    const totalRequiredCapacity = totalDesignLoad * SAFETY_FACTOR;
                    
                    // Round the final result
                    const finalBTU = Math.round(totalRequiredCapacity);

                    // --- Load Ratios ---
                    const totalLoadNoSafety = qTransmission + qInfiltration + qInternal + qProductTotal;
                    
                    const ratioTransmission = ((qTransmission / totalLoadNoSafety) * 100).toFixed(1);
                    const ratioInfiltration = ((qInfiltration / totalLoadNoSafety) * 100).toFixed(1);
                    const ratioInternal = ((qInternal / totalLoadNoSafety) * 100).toFixed(1);
                    const ratioProduct = ((qProductTotal / totalLoadNoSafety) * 100).toFixed(1);

                    // --- Display Results ---
                    document.getElementById('qTransmission').innerText = Math.round(qTransmission).toLocaleString() + ' BTU/hr';
                    document.getElementById('qInfiltration').innerText = Math.round(qInfiltration).toLocaleString() + ' BTU/hr';
                    document.getElementById('qInternal').innerText = Math.round(qInternal).toLocaleString() + ' BTU/hr';
                    document.getElementById('qChilling').innerText = Math.round(qChilling).toLocaleString() + ' BTU/hr';
                    document.getElementById('qRespiration').innerText = Math.round(qRespiration).toLocaleString() + ' BTU/hr';
                    document.getElementById('totalLoadBTU').innerText = finalBTU.toLocaleString() + ' BTU/hr';
                    
                    document.getElementById('loadRatioTransmission').innerText = isNaN(ratioTransmission) ? '0%' : ratioTransmission + '%';
                    document.getElementById('loadRatioInfiltration').innerText = isNaN(ratioInfiltration) ? '0%' : ratioInfiltration + '%';
                    document.getElementById('loadRatioInternal').innerText = isNaN(ratioInternal) ? '0%' : ratioInternal + '%';
                    document.getElementById('loadRatioProduct').innerText = isNaN(ratioProduct) ? '0%' : ratioProduct + '%';

                    
                    // --- Equipment Recommendation ---
                    let recommendation = '';
                    let tempRange = '';
                    let tdSuggestion = '';

                    if (desiredTemp < 32) {
                        tempRange = 'Low Temperature (Freezer)';
                        tdSuggestion = 'Low TD Coil (6°F-8°F) for reduced dehydration/frosting.';
                    } else if (desiredTemp >= 32 && desiredTemp <= 45) {
                        tempRange = 'Medium Temperature (Cooler)';
                        tdSuggestion = 'Medium TD Coil (10°F-12°F) for general storage.';
                    } else {
                        tempRange = 'High Temperature (Process Cooling)';
                        tdSuggestion = 'High TD Coil (15°F+) may be suitable if humidity control is not critical.';
                    }
                    
                    const approximateHP = (finalBTU / 12000).toFixed(2); // 1 Ton = 12,000 BTU/hr

                    recommendation = `
                        <p class="mt-2 text-sm text-gray-800">
                            <strong>Box Type:</strong> ${tempRange}<br>
                            <strong>Capacity Class:</strong> The calculated required capacity is approximately ${finalBTU.toLocaleString()} BTU/hr.<br>
                            <strong>Approximate HP Required:</strong> ${approximateHP} HP (Total capacity)<br>
                            <strong>Evaporator Suggestion:</strong> ${tdSuggestion}
                        </p>
                        <p class="mt-4 p-3 bg-sky-100 border border-sky-600 rounded-lg text-sm text-sky-900 font-medium">
                            Based on this load and the refrigerant specified in Section 5, look for a condensing unit and evaporator with a matched net cooling capacity of at least **${finalBTU.toLocaleString()} BTU/hr** at the design temperature.
                        </p>
                    `;
                    document.getElementById('equipmentRecommendation').innerHTML = recommendation;
                }

                // Form Submission Handler and Initialization
                document.addEventListener('DOMContentLoaded', () => {
                    const form = document.getElementById('sizerForm');
                    
                    // Event listener for calculation button
                    document.getElementById('calculateButton').addEventListener('click', (e) => {
                        e.preventDefault();
                        calculateLoad();
                        toggleCollapse('calculationSection'); // Open the results section
                    });
                    
                    // Add listeners to control fields
                    document.getElementsByName('boxUsage').forEach(radio => {
                        radio.addEventListener('change', (e) => {
                            updateUsageDefaults(e.target.value);
                        });
                    });
                    
                    document.getElementById('primaryApplication').addEventListener('change', updateTempRHDefaults); // NEW LISTENER
                    document.getElementById('productType').addEventListener('change', calculateLoad);
                    document.getElementsByName('boxLocation').forEach(radio => {
                        radio.addEventListener('change', toggleSunExposure);
                    });
                    document.getElementById('insulationType').addEventListener('change', calculateLoad); // Listen to insulation change


                    // Form submit handler (original)
                    form.addEventListener('submit', (e) => {
                        e.preventDefault();
                        showMessage("Form data simulated for submission. Use the 'Print Form' button to save or share a copy.", 'info');
                    });

                    // Initialize conditional fields
                    toggleConditionalInput('isHotColdArea', 'hotColdDescriptionField', 'Yes');
                    toggleConditionalInput('hasStripCurtains', 'stripCurtainsListField', 'Yes');
                    toggleConditionalInput('hasAirCurtains', 'airCurtainsListField', 'Yes');

                    // Add change listeners to trigger auto-calculation on input (optional, but nice UX)
                    const inputsToWatch = ['boxLong', 'boxWide', 'boxHigh', 'desiredTemp', 'ambientTemp', 'maxLoadLbs', 'enteringTemp', 'finalTemp', 'pulldownHours', 'personnelQty', 'personnelHours', 'lightingWPerSqFt', 'motorsHP'];
                    inputsToWatch.forEach(id => {
                        const el = document.getElementById(id);
                        if (el) {
                            el.addEventListener('change', calculateLoad);
                        }
                    });
                    
                    // Run initial setup and calculation after DOM load to populate Section 7 with default values
                    toggleSunExposure(); // Initial check for location/sun
                    updateUsageDefaults(getRadioValue('boxUsage')); // Apply initial usage defaults
                    calculateLoad();
                });
            </script>

            <!-- Message Container for Feedback -->
            <div id="messageContainer" class="hidden"></div>


            <!-- ------------------------------------------------------------------- -->
            <!-- SECTION 1: Contact & Submission Details -->
            <!-- ------------------------------------------------------------------- -->
            <div class="print-section mb-6">
                <div class="collapse-header flex justify-between items-center py-2" onclick="toggleCollapse('contactSection')">
                    <h2 class="text-xl font-semibold text-gray-800">1. Contact & Submission Details</h2>
                    <svg id="arrow-contactSection" class="w-5 h-5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                </div>

                <div id="contactSection" class="collapse-content open">
                    <!-- Hardcoded Contractor Details -->
                    <h3 class="text-lg font-bold text-sky-700 mb-2 mt-2">Contractor (Submitted By)</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-2 p-3 border border-sky-600 rounded-lg bg-sky-50">
                        <div class="font-bold text-gray-900 col-span-2">Mechanical Temp</div>
                        <div class="text-sm text-gray-700">23093 Telegraph Rd, Southfield MI 48033</div>
                        <div class="text-sm text-gray-700">Phone: 313-282-4758</div>
                        <div class="text-sm text-gray-700">Email: office@mechanicaltemp.com</div>
                        <div class="text-sm text-gray-700">Web: www.mechanicaltemp.com</div>
                    </div>

                    <!-- Customer Input Fields -->
                    <h3 class="text-lg font-bold text-gray-800 mb-2 mt-6 border-t pt-4">Customer / Jobsite Information</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <input type="text" placeholder="Company" class="p-3 border border-gray-300 rounded-lg focus:ring-sky-500 focus:border-sky-500" required>
                        <input type="text" placeholder="Account #" class="p-3 border border-gray-300 rounded-lg">
                        <input type="text" placeholder="Contact Person" class="p-3 border border-gray-300 rounded-lg" required>
                        <input type="tel" placeholder="Phone" class="p-3 border border-gray-300 rounded-lg">
                        <input type="text" placeholder="Job Address" class="p-3 border border-gray-300 rounded-lg col-span-2" required>
                        <input type="date" placeholder="Date Submitted" class="p-3 border border-gray-300 rounded-lg" required>
                        <input type="text" placeholder="Submitted by Branch #" class="p-3 border border-gray-300 rounded-lg">
                    </div>
                    
                    <h3 class="text-lg font-bold text-gray-800 mb-2 mt-6 border-t pt-4">Room Usage Details</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <select id="primaryApplication" class="p-3 border border-gray-300 rounded-lg w-full mb-3" required>
                            <option value="Other/General Use">Select Primary Application (Autofills Temp/RH)</option>
                            <option value="Restaurant/Food Service">Restaurant/Food Service (e.g., 38°F / 85% RH)</option>
                            <option value="Retail Store/Grocery">Retail Store/Grocery (e.g., 35°F / 80% RH)</option>
                            <option value="Industrial Process/Food Processing">Industrial Process/Food Processing (e.g., 45°F / 75% RH)</option>
                            <option value="Cold Storage Warehouse">Cold Storage Warehouse (e.g., 30°F / 70% RH)</option>
                            <option value="Frozen Storage/Freezer">Frozen Storage/Freezer (e.g., -10°F / N/A RH)</option>
                            <option value="Floral/Science Lab">Floral/Science Lab (e.g., 40°F / 90% RH)</option>
                            <option value="Other/General Use">Other/General Use (e.g., 40°F / 80% RH)</option>
                        </select>
                    </div>

                    <div class="mt-4">
                        <div class="flex flex-wrap gap-4">
                            <span class="text-gray-600 font-medium">Box usage is:</span>
                            <label class="inline-flex items-center">
                                <input type="radio" name="boxUsage" value="Regular" class="form-radio text-sky-600 h-4 w-4" checked>
                                <span class="ml-2 text-gray-700">Regular (Default)</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="radio" name="boxUsage" value="Heavy" class="form-radio text-sky-600 h-4 w-4">
                                <span class="ml-2 text-gray-700">Heavy (High Traffic)</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="radio" name="boxUsage" value="Long Storage" class="form-radio text-sky-600 h-4 w-4">
                                <span class="ml-2 text-gray-700">Long Storage (Low Traffic)</span>
                            </label>
                        </div>
                        <p class="text-xs text-gray-500 mt-2">Selecting a usage type automatically adjusts the default estimates for lighting, personnel, and motor usage in Section 4.</p>
                    </div>
                </div>
            </div>

            <!-- ------------------------------------------------------------------- -->
            <!-- SECTION 2: Box Specifications & Location -->
            <!-- ------------------------------------------------------------------- -->
            <div class="page-break print-section mb-6">
                <div class="collapse-header flex justify-between items-center py-2" onclick="toggleCollapse('specsSection')">
                    <h2 class="text-xl font-semibold text-gray-800">2. Box Specifications & Environment</h2>
                    <svg id="arrow-specsSection" class="w-5 h-5 transition-transform rotate-90" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                </div>

                <div id="specsSection" class="collapse-content">
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-3">
                        <!-- Temp & Humidity -->
                        <div class="col-span-2">
                            <label class="block text-xs font-medium text-gray-500">Desired Box Temperature (°F)</label>
                            <input type="number" step="0.1" placeholder="Temp" id="desiredTemp" class="p-3 border border-gray-300 rounded-lg w-full" required value="40">
                        </div>
                        <div class="col-span-2">
                            <label class="block text-xs font-medium text-gray-500">Humidity (% RH)</label>
                            <input type="number" min="0" max="100" placeholder="Humidity" id="desiredRH" class="p-3 border border-gray-300 rounded-lg w-full" required value="80">
                        </div>

                        <!-- Location -->
                        <div class="col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Box Location</label>
                            <div class="flex gap-4">
                                <label class="inline-flex items-center"><input type="radio" name="boxLocation" value="Indoors" class="form-radio text-sky-600 h-4 w-4" checked><span class="ml-2 text-gray-700">Indoors</span></label>
                                <label class="inline-flex items-center"><input type="radio" name="boxLocation" value="Outdoors" class="form-radio text-sky-600 h-4 w-4"><span class="ml-2 text-gray-700">Outdoors</span></label>
                            </div>
                        </div>
                        
                        <!-- Sun Exposure - Conditional based on Box Location -->
                        <div id="sunExposureField" class="col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Sun Exposure</label>
                            <div class="flex gap-4">
                                <label class="inline-flex items-center"><input type="radio" name="sunExposure" id="outdoorFullSun" value="Full Sun" class="form-radio text-sky-600 h-4 w-4"><span class="ml-2 text-gray-700">Full Sun</span></label>
                                <label class="inline-flex items-center"><input type="radio" name="sunExposure" id="outdoorPartialShade" value="Partial Shade" class="form-radio text-sky-600 h-4 w-4" checked><span class="ml-2 text-gray-700">Partial Shade</span></label>
                            </div>
                        </div>

                        <!-- Ambient Temp & Hot/Cold Area -->
                        <div class="col-span-2">
                            <label class="block text-xs font-medium text-gray-500">Ambient Temperature (°F)</label>
                            <input type="number" step="0.1" placeholder="Ambient Temp" id="ambientTemp" class="p-3 border border-gray-300 rounded-lg w-full" required value="85">
                        </div>
                        <div class="col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Near Hot/Cold Areas?</label>
                            <div class="flex gap-4">
                                <label class="inline-flex items-center"><input type="radio" name="isHotColdArea" value="Yes" class="form-radio text-sky-600 h-4 w-4"><span class="ml-2 text-gray-700">Yes</span></label>
                                <label class="inline-flex items-center"><input type="radio" name="isHotColdArea" value="No" class="form-radio text-sky-600 h-4 w-4" checked><span class="ml-2 text-gray-700">No</span></label>
                            </div>
                        </div>
                        <div id="hotColdDescriptionField" class="col-span-full hidden mt-2">
                            <label class="block text-sm font-medium text-gray-700">If Yes, describe the adjacent area:</label>
                            <textarea placeholder="e.g., Above a boiler room, Next to a freezer box" class="p-3 border border-gray-300 rounded-lg w-full h-16"></textarea>
                        </div>
                    </div>

                    <h3 class="text-lg font-medium text-gray-800 mt-6 mb-2 border-t pt-4">Box Dimensions (ft)</h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div>
                            <label class="block text-xs font-medium text-gray-500">Long (ft)</label>
                            <input type="number" step="0.01" placeholder="Length" id="boxLong" class="p-3 border border-gray-300 rounded-lg w-full" required value="10">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-500">Wide (ft)</label>
                            <input type="number" step="0.01" placeholder="Width" id="boxWide" class="p-3 border border-gray-300 rounded-lg w-full" required value="10">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-500">High (ft)</label>
                            <input type="number" step="0.01" placeholder="Height" id="boxHigh" class="p-3 border border-gray-300 rounded-lg w-full" required value="8">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-500">Elevation (ft)</label>
                            <input type="number" step="0.01" placeholder="Elevation" class="p-3 border border-gray-300 rounded-lg w-full">
                        </div>
                    </div>
                </div>
            </div>

            <!-- ------------------------------------------------------------------- -->
            <!-- SECTION 3: Insulation & Doors -->
            <!-- ------------------------------------------------------------------- -->
            <div class="page-break print-section mb-6">
                <div class="collapse-header flex justify-between items-center py-2" onclick="toggleCollapse('insulationSection')">
                    <h2 class="text-xl font-semibold text-gray-800">3. Insulation & Door Details</h2>
                    <svg id="arrow-insulationSection" class="w-5 h-5 transition-transform rotate-90" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                </div>

                <div id="insulationSection" class="collapse-content">
                    <div class="mt-3">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Insulation Type (Affects U-Value calculation)</label>
                        <select id="insulationType" class="p-3 border border-gray-300 rounded-lg w-full mb-4">
                            <option>Select Insulation Type</option>
                            <option value="Polyurethane" selected>Polyurethane (Default)</option>
                            <option value="Styrofoam">Styrofoam</option>
                            <option value="Fiberglass">Fiberglass</option>
                            <option value="Urethane">Urethane</option>
                            <option value="Concrete">Concrete</option>
                        </select>
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Was the walk-In box manufactured on or after January 1, 2009?</label>
                            <div class="flex gap-4">
                                <label class="inline-flex items-center"><input type="radio" name="isNewBox" value="Yes" class="form-radio text-sky-600 h-4 w-4"><span class="ml-2 text-gray-700">Yes</span></label>
                                <label class="inline-flex items-center"><input type="radio" name="isNewBox" value="No" class="form-radio text-sky-600 h-4 w-4" checked><span class="ml-2 text-gray-700">No</span></label>
                            </div>
                        </div>

                        <!-- REMOVED: Exterior Surface Details Table -->
                        <!-- The calculation now uses the Insulation Type above for a standardized U-Value. -->

                        <h3 class="text-lg font-medium text-gray-800 mt-6 mb-2 border-t pt-4">Door Configuration</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xs font-medium text-gray-500">Total Doors (Quantity)</label>
                                <input type="number" min="0" placeholder="Quantity" class="p-3 border border-gray-300 rounded-lg w-full" required value="1">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Door Operation</label>
                                <div class="flex gap-4 pt-1">
                                    <label class="inline-flex items-center"><input type="radio" name="doorOperation" value="Manual" class="form-radio text-sky-600 h-4 w-4" checked><span class="ml-2 text-gray-700">Manual</span></label>
                                    <label class="inline-flex items-center"><input type="radio" name="doorOperation" value="Electric" class="form-radio text-sky-600 h-4 w-4"><span class="ml-2 text-gray-700">Electric</span></label>
                                </div>
                            </div>
                            <div class="col-span-full">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Door Types (Check all that apply)</label>
                                <div class="flex flex-wrap gap-4">
                                    <label class="inline-flex items-center"><input type="checkbox" name="doorTypes" value="Standard" class="form-checkbox text-sky-600 h-4 w-4" checked><span class="ml-2 text-gray-700">Standard</span></label>
                                    <label class="inline-flex items-center"><input type="checkbox" name="doorTypes" value="Sliding" class="form-checkbox text-sky-600 h-4 w-4"><span class="ml-2 text-gray-700">Sliding</span></label>
                                    <label class="inline-flex items-center"><input type="checkbox" name="doorTypes" value="Glass" class="form-checkbox text-sky-600 h-4 w-4"><span class="ml-2 text-gray-700">Glass</span></label>
                                    <label class="inline-flex items-center"><input type="checkbox" name="doorTypes" value="Dock" class="form-checkbox text-sky-600 h-4 w-4"><span class="ml-2 text-gray-700">Dock</span></label>
                                </div>
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-4 mt-4">
                            <div>
                                <label class="block text-xs font-medium text-gray-500">Area Door Opens Into: Temp (°F)</label>
                                <input type="number" step="0.1" placeholder="Temp" class="p-3 border border-gray-300 rounded-lg w-full" required value="75">
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-500">Area Door Opens Into: RH (%)</label>
                                <input type="number" min="0" max="100" step="1" placeholder="RH" class="p-3 border border-gray-300 rounded-lg w-full" required value="50">
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4 border-t pt-4">
                            <!-- Strip Curtains -->
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Strip curtains on any doors?</label>
                                <div class="flex gap-4">
                                    <label class="inline-flex items-center"><input type="radio" name="hasStripCurtains" value="Yes" class="form-radio text-sky-600 h-4 w-4"><span class="ml-2 text-gray-700">Yes</span></label>
                                    <label class="inline-flex items-center"><input type="radio" name="hasStripCurtains" value="No" class="form-radio text-sky-600 h-4 w-4" checked><span class="ml-2 text-gray-700">No</span></label>
                                </div>
                                <div id="stripCurtainsListField" class="hidden mt-2">
                                    <input type="text" placeholder="List doors with strip curtains" class="p-3 border border-gray-300 rounded-lg w-full">
                                </div>
                            </div>
                            <!-- Air Curtains -->
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Air curtains on any doors?</label>
                                <div class="flex gap-4">
                                    <label class="inline-flex items-center"><input type="radio" name="hasAirCurtains" value="Yes" class="form-radio text-sky-600 h-4 w-4"><span class="ml-2 text-gray-700">Yes</span></label>
                                    <label class="inline-flex items-center"><input type="radio" name="hasAirCurtains" value="No" class="form-radio text-sky-600 h-4 w-4" checked><span class="ml-2 text-gray-700">No</span></label>
                                </div>
                                <div id="airCurtainsListField" class="hidden mt-2">
                                    <input type="text" placeholder="List doors with air curtains" class="p-3 border border-gray-300 rounded-lg w-full">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ------------------------------------------------------------------- -->
            <!-- SECTION 4: Internal Loads (Product & Usage) -->
            <!-- ------------------------------------------------------------------- -->
            <div class="page-break print-section mb-6">
                <div class="collapse-header flex justify-between items-center py-2" onclick="toggleCollapse('loadSection')">
                    <h2 class="text-xl font-semibold text-gray-800">4. Internal Loads & Product Data</h2>
                    <svg id="arrow-loadSection" class="w-5 h-5 transition-transform rotate-90" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                </div>

                <div id="loadSection" class="collapse-content">
                    <h3 class="text-lg font-medium text-gray-800 mt-3 mb-2">Product Details</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        
                        <!-- NEW PRODUCT DROPDOWN -->
                        <select id="productType" class="p-3 border border-gray-300 rounded-lg w-full" required>
                            <option value="Generic Cooler Items">Generic Cooler Items (Default)</option>
                            <option value="Chilled Meat/Poultry">Chilled Meat/Poultry (Above 32°F)</option>
                            <option value="Fresh Produce (Respiration Load)">Fresh Produce (Respiration Load)</option>
                            <option value="Dairy/Milk/Eggs">Dairy/Milk/Eggs</option>
                            <option value="Beverages/Canned Goods">Beverages/Canned Goods</option>
                            <option value="Frozen Food (Below 32F)">Frozen Food (Below 32°F)</option>
                        </select>
                        <!-- END NEW PRODUCT DROPDOWN -->

                        <input type="text" placeholder="Packaging (e.g., Cardboard, Plastic Wrap, None)" class="p-3 border border-gray-300 rounded-lg" required value="Cardboard Boxes">
                        
                        <div class="col-span-full">
                            <label class="block text-xs font-medium text-gray-500">Maximum Load (lbs. per day)</label>
                            <input type="number" step="0.1" placeholder="Max Load (lbs/day)" id="maxLoadLbs" class="p-3 border border-gray-300 rounded-lg w-full" required value="1000">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-500">Entering Temperature (°F)</label>
                            <input type="number" step="0.1" placeholder="Entering Temp" id="enteringTemp" class="p-3 border border-gray-300 rounded-lg w-full" required value="70">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-500">Final Temperature (°F)</label>
                            <input type="number" step="0.1" placeholder="Final Temp" id="finalTemp" class="p-3 border border-gray-300 rounded-lg w-full" required value="40">
                        </div>
                        <div class="col-span-full">
                            <label class="block text-xs font-medium text-gray-500">Pull Down In (Hours)</label>
                            <input type="number" step="0.1" placeholder="Hours" id="pulldownHours" class="p-3 border border-gray-300 rounded-lg w-full" required value="12">
                        </div>
                    </div>

                    <h3 class="text-lg font-medium text-gray-800 mt-6 mb-2 border-t pt-4">Equipment & Usage (Auto-filled by Box Usage)</h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <!-- Lighting -->
                        <div class="col-span-2">
                            <label class="block text-xs font-medium text-gray-500">Lighting (Watts per sq. foot)</label>
                            <input type="number" step="0.01" placeholder="W/sq ft" id="lightingWPerSqFt" class="p-3 border border-gray-300 rounded-lg w-full" required value="1.5">
                        </div>
                        <!-- Motors -->
                        <div class="col-span-2">
                            <label class="block text-xs font-medium text-gray-500">Motors (HP)</label>
                            <input type="number" step="0.01" placeholder="HP" id="motorsHP" class="p-3 border border-gray-300 rounded-lg w-full" required value="0.5">
                        </div>

                        <!-- Personnel -->
                        <div class="col-span-2">
                            <label class="block text-sm font-medium text-gray-700">Personnel (Qty / Hours/day)</label>
                            <div class="flex gap-2">
                                <input type="number" min="0" placeholder="Qty" id="personnelQty" class="p-3 border border-gray-300 rounded-lg w-1/2" required value="1">
                                <input type="number" min="0" step="0.1" placeholder="Hours/day" id="personnelHours" class="p-3 border border-gray-300 rounded-lg w-1/2" required value="4">
                            </div>
                        </div>

                        <!-- Forklifts -->
                        <div class="col-span-2">
                            <label class="block text-sm font-medium text-gray-700">Forklifts (Qty / Hours/day)</label>
                            <div class="flex gap-2">
                                <input type="number" min="0" placeholder="Qty" class="p-3 border border-gray-300 rounded-lg w-1/2" required value="0">
                                <input type="number" min="0" step="0.1" placeholder="Hours/day" class="p-3 border border-gray-300 rounded-lg w-1/2" required value="0">
                            </div>
                        </div>

                        <!-- Pallet Jacks -->
                        <div class="col-span-2">
                            <label class="block text-sm font-medium text-gray-700">Pallet Jacks (Qty / Hours/day)</label>
                            <div class="flex gap-2">
                                <input type="number" min="0" placeholder="Qty" class="p-3 border border-gray-300 rounded-lg w-1/2" required value="0">
                                <input type="number" min="0" step="0.1" placeholder="Hours/day" class="p-3 border border-gray-300 rounded-lg w-1/2" required value="0">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ------------------------------------------------------------------- -->
            <!-- SECTION 5: Refrigeration System & Electrical -->
            <!-- ------------------------------------------------------------------- -->
            <div class="page-break print-section mb-6">
                <div class="collapse-header flex justify-between items-center py-2" onclick="toggleCollapse('systemSection')">
                    <h2 class="text-xl font-semibold text-gray-800">5. Refrigeration System & Power</h2>
                    <svg id="arrow-systemSection" class="w-5 h-5 transition-transform rotate-90" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                </div>

                <div id="systemSection" class="collapse-content">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-3">
                        <input type="text" placeholder="Refrigerant (e.g., R-404A, R-448A)" class="p-3 border border-gray-300 rounded-lg" required value="R-448A">
                        <select class="p-3 border border-gray-300 rounded-lg">
                            <option>Select Compressor Type</option>
                            <option>Semi-Hermetic</option>
                            <option>Hermetic</option>
                            <option>Scroll</option>
                        </select>
                        <input type="text" placeholder="Brand Preferred (e.g., Copeland, Danfoss)" class="p-3 border border-gray-300 rounded-lg" required value="Danfoss">
                        <div>
                            <label class="block text-xs font-medium text-gray-500">Desired Evaporator TD (°F)</label>
                            <input type="number" step="0.1" placeholder="TD (°F)" class="p-3 border border-gray-300 rounded-lg w-full" required value="10">
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-4 mt-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Condensing Units to be cooled:</label>
                            <div class="flex gap-4">
                                <label class="inline-flex items-center"><input type="radio" name="coolingType" value="Air" class="form-radio text-sky-600 h-4 w-4" checked><span class="ml-2 text-gray-700">Air</span></label>
                                <label class="inline-flex items-center"><input type="radio" name="coolingType" value="Water" class="form-radio text-sky-600 h-4 w-4"><span class="ml-2 text-gray-700">Water</span></label>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Condensing Units to be located:</label>
                            <div class="flex gap-4">
                                <label class="inline-flex items-center"><input type="radio" name="condensingLocation" value="Indoors" class="form-radio text-sky-600 h-4 w-4"><span class="ml-2 text-gray-700">Indoors</span></label>
                                <label class="inline-flex items-center"><input type="radio" name="condensingLocation" value="Outdoors" class="form-radio text-sky-600 h-4 w-4" checked><span class="ml-2 text-gray-700">Outdoors</span></label>
                            </div>
                        </div>
                    </div>

                    <h3 class="text-lg font-medium text-gray-800 mt-6 mb-2 border-t pt-4">Electrical Power Available</h3>
                    <div class="grid grid-cols-3 gap-4 border p-3 rounded-lg bg-gray-50">
                        <div class="text-sm font-semibold text-gray-700">System</div>
                        <div class="text-sm font-semibold text-gray-700">Voltage (V)</div>
                        <div class="text-sm font-semibold text-gray-700">Phase (PH) / Freq (Hz)</div>

                        <!-- Condensing Units -->
                        <div class="text-sm font-medium pt-2">Condensing Units:</div>
                        <input type="number" placeholder="V" class="p-2 border border-gray-300 rounded-lg" required value="208">
                        <input type="text" placeholder="PH / Hz" class="p-2 border border-gray-300 rounded-lg" required value="3PH/60Hz">

                        <!-- Evaporator Coils -->
                        <div class="text-sm font-medium pt-2">Evaporator Coils:</div>
                        <input type="number" placeholder="V" class="p-2 border border-gray-300 rounded-lg" required value="120">
                        <input type="text" placeholder="PH / Hz" class="p-2 border border-gray-300 rounded-lg" required value="1PH/60Hz">
                    </div>
                </div>
            </div>

            <!-- ------------------------------------------------------------------- -->
            <!-- SECTION 6: Comments -->
            <!-- ------------------------------------------------------------------- -->
            <div class="print-section mb-6">
                <div class="collapse-header flex justify-between items-center py-2" onclick="toggleCollapse('commentsSection')">
                    <h2 class="text-xl font-semibold text-gray-800">6. Comments / Additional Info</h2>
                    <svg id="arrow-commentsSection" class="w-5 h-5 transition-transform rotate-90" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                </div>

                <div id="commentsSection" class="collapse-content">
                    <div class="mt-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Comments / Additional Info:</label>
                        <textarea placeholder="Include any details about irregular shapes, door locations, or special requirements here. Enter '0' or 'N/A' for non-applicable questions." class="p-3 border border-gray-300 rounded-lg w-full h-32"></textarea>
                    </div>
                </div>
            </div>
            
            <!-- ------------------------------------------------------------------- -->
            <!-- SECTION 7: Load Calculation & Equipment Selection -->
            <!-- ------------------------------------------------------------------- -->
            <div class="print-section mb-6">
                <div class="collapse-header flex justify-between items-center py-2 bg-sky-600 text-white border-y border-sky-700" onclick="toggleCollapse('calculationSection')">
                    <h2 class="text-xl font-extrabold">7. Load Calculation & Equipment Selection</h2>
                    <svg id="arrow-calculationSection" class="w-5 h-5 transition-transform rotate-90" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                </div>

                <div id="calculationSection" class="collapse-content">
                    <h3 class="text-lg font-medium text-gray-800 mt-3 mb-2">Calculated Heat Loads (BTU/hr)</h3>
                    <div class="grid grid-cols-2 gap-4 p-4 rounded-lg bg-gray-50 border">
                        <div class="text-sm font-medium text-gray-600">1. Transmission Load (Walls, Floor, Ceiling):</div>
                        <div class="text-sm font-bold text-right text-gray-800" id="qTransmission">0 BTU/hr</div>
                        
                        <div class="text-sm font-medium text-gray-600">2. Infiltration Load (Door/Air Leakage):</div>
                        <div class="text-sm font-bold text-right text-gray-800" id="qInfiltration">0 BTU/hr</div>

                        <div class="text-sm font-medium text-gray-600">3. Internal Load (Lights, Motors, People):</div>
                        <div class="text-sm font-bold text-right text-gray-800" id="qInternal">0 BTU/hr</div>

                        <div class="text-sm font-medium text-gray-600 pl-4">3a. Product Chilling/Freezing Load:</div>
                        <div class="text-sm font-bold text-right text-gray-800" id="qChilling">0 BTU/hr</div>
                        
                        <div class="text-sm font-medium text-gray-600 pl-4">3b. Product Respiration Load:</div>
                        <div class="text-sm font-bold text-right text-gray-800" id="qRespiration">0 BTU/hr</div>

                        <div class="col-span-2 h-px bg-gray-200 my-2"></div>
                        
                        <div class="text-lg font-bold text-sky-700">TOTAL REQUIRED CAPACITY (with 15% Safety):</div>
                        <div class="text-lg font-extrabold text-right text-sky-700" id="totalLoadBTU">0 BTU/hr</div>
                    </div>

                    <h3 class="text-lg font-medium text-gray-800 mt-6 mb-2 border-t pt-4">Load Ratios (No Safety Factor)</h3>
                    <div class="grid grid-cols-2 gap-4 p-4 rounded-lg bg-yellow-50 border border-yellow-200 text-sm">
                        <div class="font-medium text-gray-700">Transmission %:</div>
                        <div class="text-right font-bold text-gray-900" id="loadRatioTransmission">0%</div>
                        <div class="font-medium text-gray-700">Infiltration %:</div>
                        <div class="text-right font-bold text-gray-900" id="loadRatioInfiltration">0%</div>
                        <div class="font-medium text-gray-700">Internal %:</div>
                        <div class="text-right font-bold text-gray-900" id="loadRatioInternal">0%</div>
                        <div class="font-medium text-gray-700">Product %:</div>
                        <div class="text-right font-bold text-gray-900" id="loadRatioProduct">0%</div>
                    </div>

                    <h3 class="text-lg font-medium text-gray-800 mt-6 mb-2 border-t pt-4">Equipment Recommendation</h3>
                    <div id="equipmentRecommendation" class="p-3 bg-white rounded-lg border border-gray-200">
                        <p class="text-gray-500">Click the "Calculate Load" button to generate a recommendation.</p>
                    </div>
                </div>
            </div>

            <!-- ------------------------------------------------------------------- -->
            <!-- SECTION 8: Refrigeration Cheatsheet & Pointers (NEW SECTION) -->
            <!-- ------------------------------------------------------------------- -->
            <div class="print-section mb-6">
                <div class="collapse-header flex justify-between items-center py-2 bg-gray-100 border-y border-gray-300" onclick="toggleCollapse('cheatsheetSection')">
                    <h2 class="text-xl font-semibold text-gray-800">8. Refrigeration Cheatsheet & Pointers</h2>
                    <svg id="arrow-cheatsheetSection" class="w-5 h-5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                </div>

                <div id="cheatsheetSection" class="collapse-content">
                    <div class="mt-3 p-4 bg-white rounded-b-lg border border-t-0">
                        
                        <h3 class="text-lg font-bold text-gray-700 mb-2">Evaporator TD (Temperature Difference) Quick Guide</h3>
                        <p class="text-sm text-gray-600 mb-4">TD is the difference between the box air temperature and the refrigerant's saturated suction temperature (SST). A smaller TD generally means higher air humidity and better product preservation.</p>
                        
                        <div class="grid grid-cols-3 gap-4 text-sm font-medium text-center">
                            <div class="bg-sky-50 p-2 rounded-lg border border-sky-200">
                                <strong>Low TD (6°F - 8°F)</strong><br>
                                <span class="text-xs text-sky-700">Required for Freezers and high-humidity products (Produce, Floral).</span>
                            </div>
                            <div class="bg-sky-50 p-2 rounded-lg border border-sky-200">
                                <strong>Medium TD (10°F - 12°F)</strong><br>
                                <span class="text-xs text-sky-700">Standard for general coolers (Dairy, Meat, Beverages).</span>
                            </div>
                            <div class="bg-sky-50 p-2 rounded-lg border border-sky-200">
                                <strong>High TD (15°F+)</strong><br>
                                <span class="text-xs text-sky-700">For non-sensitive products or quick pulldown (lower capital cost).</span>
                            </div>
                        </div>

                        <h3 class="text-lg font-bold text-gray-700 mt-6 mb-2 border-t pt-4">Insulation R-Value Pointers</h3>
                        <p class="text-sm text-gray-600 mb-2">The R-value measures thermal resistance. A higher R-value means lower heat loss (Transmission Load).</p>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200 text-sm">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-3 py-2 text-left text-xs font-semibold text-gray-500 uppercase">Insulation Type</th>
                                        <th class="px-3 py-2 text-left text-xs font-semibold text-gray-500 uppercase">Approx. R-Value per Inch</th>
                                        <th class="px-3 py-2 text-left text-xs font-semibold text-gray-500 uppercase">Typical Use</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200">
                                    <tr><td class="px-3 py-2">Polyurethane/Urethane</td><td class="px-3 py-2 font-mono">~R-7.0 / in</td><td class="px-3 py-2">Standard for modern walk-ins/freezers.</td></tr>
                                    <tr><td class="px-3 py-2">Styrofoam (Extruded)</td><td class="px-3 py-2 font-mono">~R-5.0 / in</td><td class="px-3 py-2">Older boxes, general construction.</td></tr>
                                    <tr><td class="px-3 py-2">Fiberglass</td><td class="px-3 py-2 font-mono">~R-3.5 / in</td><td class="px-3 py-2">Building construction (less common for walk-in panels).</td></tr>
                                </tbody>
                            </table>
                        </div>

                        <h3 class="text-lg font-bold text-gray-700 mt-6 mb-2 border-t pt-4">Simplified Walk-In Temperature Guide</h3>
                        <ul class="list-disc list-inside text-sm text-gray-600 space-y-1">
                            <li>**Beer Cooler:** 35°F - 38°F</li>
                            <li>**General Food Storage:** 38°F - 40°F (Default Cooler)</li>
                            <li>**Fresh Produce:** 32°F - 40°F (High RH, Low TD)</li>
                            <li>**Ice Cream / Frozen Food:** -10°F to 0°F (Default Freezer)</li>
                        </ul>

                    </div>
                </div>
            </div>

            <!-- ------------------------------------------------------------------- -->
            <!-- Form Actions -->
            <!-- ------------------------------------------------------------------- -->
            <div class="print-hidden flex flex-col sm:flex-row gap-4 justify-end mt-8 border-t pt-6">
                <button type="button" id="calculateButton" class="bg-sky-500 text-white hover:bg-sky-600 font-semibold py-3 px-6 rounded-lg transition-colors shadow-md order-1 sm:order-0">
                    Calculate Load
                </button>
                <button type="button" onclick="document.getElementById('sizerForm').reset()" class="bg-gray-200 text-gray-700 hover:bg-gray-300 font-semibold py-3 px-6 rounded-lg transition-colors shadow-md order-2 sm:order-1">
                    Reset Form
                </button>
                <button type="button" onclick="printForm()" class="bg-gray-700 text-white hover:bg-gray-800 font-semibold py-3 px-6 rounded-lg transition-colors shadow-md order-3 sm:order-2">
                    Print Form / Save as PDF
                </button>
                <button type="submit" class="bg-green-500 text-white hover:bg-green-600 font-semibold py-3 px-6 rounded-lg transition-colors shadow-md order-4 sm:order-3">
                    Submit Analysis
                </button>
            </div>
        </form>
    </div>
</body>
</html>
